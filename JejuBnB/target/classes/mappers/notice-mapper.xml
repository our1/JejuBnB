<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="noticeMapper">
	<resultMap type="Notice" id="resultNotice">
		<id column="noticeno" property="noticeno" />
		<result property="noticetitle" column="noticetitle" />
		<result property="noticedate" column="noticedate" />
		<result property="noticewriter" column="noticewriter" />
		<result property="noticecontent" column="noticecontent" />
		<result property="original_filepath" column="original_filepath" />
		<result property="rename_filepath" column="rename_filepath" />
	</resultMap>
	<select id="selectList" resultMap="resultNotice">
	select * from notice order by noticeno desc
	</select>
	<select id="selectOne" parameterType="int" resultMap="resultNotice">
	select * from notice where noticeno = #{noticeno}
	</select>
	<select id="selectNewTop3" resultMap="resultNotice">
	<![CDATA[
	SELECT * FROM (SELECT ROWNUM RNUM, NOTICENO, NOTICETITLE, NOTICEDATE" 
				      FROM (SELECT * FROM NOTICE" 
				            ORDER BY NOTICEDATE DESC)) 
				WHERE RNUM >= 1 AND RNUM <= 3 ]]>
	</select>
	<delete id="deleteNotice" parameterType="int">
	delete from notice where noticeno = #{noticeno}
	</delete>
	<insert id="insertNotice" parameterType="Notice">
	insert into notice 
	<if test="original_Filepath != null">
	values ((select max(noticeno)+1 from notice), #{noticetitle}, sysdate,
	 #{noticeWriter}, #{noticecontent}, #{original_filepath}, #{rename_filepath})
	 </if>
	 <if test="original_Filepath == null">
	 (noticeno, noticetitle, noticedate, noticewriter, noticecontent)
	 values ((select max(noticeno)+1 from notice), #{noticetitle}, sysdate,
	 #{noticewriter}, #{noticecontent})
	 </if>
	</insert>
	<update id="updateNotice" parameterType="Notice">
	update notice set noticetitle = #{noticetitle}, noticecontent = #{noticecontent}, 
	noticedate = sysdate	
	<if test="original_Filepath != null">
	, original_filepath = #{original_filepath},
	 rename_filepath = #{rename_filepath}
	</if> 
	<if test="original_Filepath == null">
	, original_filepath = null,
	 rename_filepath = null
	</if> 
	  where noticeno = #{noticeno}
	</update>


</mapper>
